# A test suite for your application

# I use this file to dev and test the linter

feature "My Application Feature"
actors {
    Web
    Terminal
    FileSystem
}

var TEST = "test"
var Ttest = "test2"
env HOME

#setting: timeout_seconds = 30

settings {
  # Set a custom timeout for this test suite.
  timeout_seconds = 301
  # Specify the output directory for reports.
  report_path = "/"
  # (report_format defaults to "json" if not specified)
  # Stop the entire run as soon as one test fails.
  stop_on_failure = true
  # Specify the shell to use for the Terminal actor, defaults to bash.
  shell_path = "bash"
  expected_failures = 101
}

background {
    Web set_header "User Agent" "choreo-test-runner_1.0"
    Web set_header "Acept" "application/json"
    Web set_header "Content-Type" "application/json"
    Web set_header "Content-Type" "text/plain"
    Web set_header "Authorization" "Bearer XYZ"
    Web set_cookie "session_id" "abc123"
}

scenario "A basic scenario" {

    test MyTest "Testing for the linter" {
        given:
            wait >= 301s
        when:
            FileSystem create_dir "temp_data"
            FileSystem create_file "temp_data/initial.txt" with_content "setup data"
            Terminal runs "cat temp_data/initial.txt"
        then:
            Terminal output_contains "setup data"
    }

    test GetInitialData "retrieve the current state of a resource" {
        given:
            # No preconditions needed
            Test can_start
        when:
            Web http_get "http://user:password@example.org/json"
        then:
            #Web response_status_is 200
            Web response_time is_below 1ms
            Web response_status is_in [200, 204, 600, 99]
            Web response_body_contains "slideshow"
            Web json_body has_path "/slideshow/title"
    }

    after {
        FileSystem delete_file "temp_data/initial.txt"
        FileSystem delete_dir "temp_data"
    }

}

scenario "A basic scenario" {

}